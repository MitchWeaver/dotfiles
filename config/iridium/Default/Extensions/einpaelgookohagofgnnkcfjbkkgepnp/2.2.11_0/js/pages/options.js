"use strict";!function(){var e={checkbox:function(e,t,n){chrome.runtime.sendMessage({action:e},function(a){"boolean"==typeof a?UI.getElementById(n,function(e){UI.isCheckbox(e)&&(e.checked=a,UI.addEvent(e,"change",function(){chrome.runtime.sendMessage({action:t,data:{enabled:e.checked}})}))}):console.error('API method "'+e+'" returns invalid answer')})}};if("object"==typeof browser){var t=document.querySelector("#javascript_protection_enabled").closest("div.left");[t,t.nextElementSibling].forEach(function(e){e.style.display="none"})}e.checkbox("settings.getEnabled","settings.setEenabled","extension_enabled"),e.checkbox("settings.getRenewEnabled","settings.setRenewEnabled","auto_renew"),chrome.runtime.sendMessage({action:"settings.getRenewInterval"},function(e){"number"==typeof e?UI.getElementById("auto_renew_interval",function(t){(UI.isInputNumber(t)||UI.isInputText(t))&&(t.value=e,UI.addEvent(t,"change",function(){var e=parseInt(t.value,10);t.value=e>1440?1440:t.value,chrome.runtime.sendMessage({action:"settings.setRenewInterval",data:{interval:t.value}})}))}):console.error('API method "settings.getRenewInterval" returns invalid answer')}),e.checkbox("settings.getRenewOnstartupEnabled","settings.setRenewOnstartupEnabled","auto_renew_onstartup"),e.checkbox("settings.getJavascriptProtectionEnabled","settings.setJavascriptProtectionEnabled","javascript_protection_enabled"),e.checkbox("settings.getSyncEnabled","settings.setSyncEnabled","sync_enabled"),chrome.runtime.sendMessage({action:"settings.getCustomUseragentList"},function(e){"[object Array]"===Object.prototype.toString.call(e)?UI.getElementById("custom_useragent_list",function(t){UI.isTextarea(t)&&(t.value=e.join("\n"),UI.addEvent(t,"change",function(){chrome.runtime.sendMessage({action:"settings.setCustomUseragentList",data:{useragents:t.value.split("\n")}},function(e){!0!==e&&console.error('API method "settings.setCustomUseragentList" failed')})}))}):console.error('API method "settings.getCustomUseragentList" returned an invalid response (no array)')}),e.checkbox("settings.getCustomUseragentEnabled","settings.setCustomUseragentEnabled","custom_useragent_enabled"),chrome.runtime.sendMessage({action:"generator.getTypes"},function(e){"[object Array]"===Object.prototype.toString.call(e)?UI.getElementById("generator_settings",function(t){var n=(new UAGenerator).useragents,a=[];if("object"==typeof n)for(var s in n)for(var r in n[s])if(n.hasOwnProperty(s)&&n[s].hasOwnProperty(r)){var o=n[s][r];if(o.hasOwnProperty("name")){var i=o.name,c=s+"_"+r;a.push({name:i,type:c})}}if(a.length>0){var l=document.createElement("ul");l.className="generator-types";for(var g=0,u=a.length;g<u;g++){var d=document.createElement("li"),p=e.indexOf(a[g].type)>=0?"checked":"";d.innerHTML='<label><span class="box-min"><input type="checkbox" '+p+' data-type="'+a[g].type+'" class="generator-type" /><i></i></span>'+a[g].name+"</label>",l.appendChild(d)}t.appendChild(l),UI.forEachCssClass("generator-type",function(e){UI.addEvent(e,"change",function(){var e=document.getElementsByClassName("generator-type");if("object"==typeof e&&e.length>0){for(var t=[],n=0,a=e.length;n<a;n++){var s,r=e[n];!0===r.checked&&null!==(s=void 0!==r.getAttribute("data-type")?r.getAttribute("data-type"):null)&&t.push(s)}chrome.runtime.sendMessage({action:"generator.setTypes",data:{types:t}},function(e){!0!==e&&console.error('API method "generator.setTypes" failed')})}chrome.runtime.sendMessage({action:"useragent.renew"},function(){})})})}}):console.error('API method "generator.getTypes" returns invalid answer')}),chrome.runtime.sendMessage({action:"exceptions.get"},function(e){"[object Array]"===Object.prototype.toString.call(e)?UI.getElementById("exceptions_patterns",function(t){UI.isTextarea(t)&&(t.value=e.join("\n"),UI.addEvent(t,"change",function(){var e=t.value.split("\n");chrome.runtime.sendMessage({action:"exceptions.set",data:{exceptions:e}},function(e){!0!==e&&console.error('API method "exceptions.set" failed')})}))}):console.error('API method "exceptions.get" returns invalid answer (not array)')}),UI.forEachWithDataAttrib("l10n",function(e,t){UI.localizeElement(e,t)})}();